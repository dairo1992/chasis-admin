<!-- src/common/layout/layout.component.html -->
<div class="flex h-screen bg-base-100">
  <!-- Sidebar -->
  <div class="sidebar bg-base-200"
    [ngClass]="{ 'collapsed': isCollapsed && !isExpandedOnHover, 'expanded': !isCollapsed || isExpandedOnHover }"
    (mouseenter)="onMouseEnter()" (mouseleave)="onMouseLeave()">
    <div class="flex items-center justify-between p-4">
      @if (!isCollapsed || isExpandedOnHover) {
      <span class="font-bold text-lg">Chasis Admin</span>
      }
    </div>

    <!-- Dynamic Menu -->
    <ul class="menu p-4">
      @for (menuItem of menuItems(); track menuItem.label) {
      @if (menuItem.children && menuItem.children.length > 0) {
      <!-- Collapsible submenu -->
      <li>
        <details [open]="isMenuItemExpanded(menuItem.label)">
          <summary class="cursor-pointer relative" (click)="toggleMenuItem(menuItem.label)">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
              stroke="currentColor" class="size-6">
              <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="menuItem.icon" />
            </svg>
            @if (!isCollapsed || isExpandedOnHover) {
            <span class="menu-text ">{{ menuItem.label }}</span>
            }
          </summary>
          @if (!isCollapsed || isExpandedOnHover) {
          <ul>
            @for (subItem of menuItem.children; track subItem.label) {
            <li>
              <a [routerLink]="subItem.path" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }"
                (click)="onMenuItemClick()" class="relative">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                  stroke="currentColor" class="size-5 ">
                  <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="subItem.icon" />
                </svg>
                <span class=" font-semibold">{{ subItem.label }}</span>
              </a>
            </li>
            }
          </ul>
          }
        </details>
      </li>
      } @else {
      <!-- Simple menu item -->
      <li>
        <a [routerLink]="menuItem.path || '/'" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }"
          (click)="onMenuItemClick()" class="relative">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
            class="size-6">
            <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="menuItem.icon" />
          </svg>
          @if (!isCollapsed || isExpandedOnHover) {
          <span class="menu-text">{{ menuItem.label }}</span>
          }
        </a>
      </li>
      }
      }
    </ul>

    <!-- Footer del sidebar -->
    @if (!isCollapsed || isExpandedOnHover) {
    <div class="mt-auto p-4 border-t border-base-300">
      <div class="flex items-center gap-3">
        <div class="avatar placeholder">
          <div class="bg-neutral text-neutral-content rounded-full w-8">
            <span class="text-xs">JD</span>
          </div>
        </div>
        <div class="flex-1 min-w-0">
          <p class="text-sm font-medium text-base-content truncate">John Doe</p>
          <p class="text-xs text-base-content/60 truncate">john.doe@example.com</p>
        </div>
      </div>
    </div>
    }
  </div>

  <!-- Main content -->
  <div class="flex-1 flex flex-col overflow-hidden">
    <!-- Header -->
    <app-header (toggleSidebar)="toggleSidebar()"></app-header>

    <!-- Breadcrumb -->
    <div class="px-4 py-2 bg-base-50 border-b border-base-200">
      <app-breadcrumb></app-breadcrumb>
    </div>

    <!-- Page content -->
    <main class="flex-1 overflow-x-hidden overflow-y-auto bg-base-100 p-4">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>